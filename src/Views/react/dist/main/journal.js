export default import(pathname("/jsx/imports")).then((async({React:e,clsx:t,Sweetalert2:a,getAsyncImport:o})=>{const{default:{MainContext:n}}=await o("/jsx/context"),{default:l}=await o("/jsx/global/modal"),{default:r}=await o("/jsx/global/pdfviewer"),{default:s}=await o("/jsx/main/search");function i({id:t,title:o,month:l,year:r,volume:s,number:i,publishedDate:c,thumbnail:m,onRefresh:u,onSelect:d}){const{authenticated:h,authData:f}=e.useContext(n);e.useCallback((e=>{e.preventDefault(),e.stopPropagation();const o=new URL(pathname("/api/journal/markfavorite"),window.location.origin),n=JSON.stringify({id:t,[f?.account]:f?.id});fetch(o,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8",Accept:"application/json; charset=UTF-8"},body:n}).then((e=>e.json())).then((({success:e,error:t})=>{t?a.fire({icon:"error",title:"Error",text:"Failed to mark journal as favorite: "+t,toast:!0,showConfirmButton:!1,position:"center",timer:3e3}):e?u&&u():a.fire({icon:"error",title:"Error",text:"Failed to mark journal as favorite",toast:!0,showConfirmButton:!1,position:"center",timer:3e3})})).catch(console.log)}),[t,f]);return e.createElement(e.Fragment,null,e.createElement("div",{onClick:()=>d&&d(t),className:"text-center relative cursor-pointer border rounded-lg p-4 w-[70mm] hover:bg-gray-200"},e.createElement("div",{className:"flex flex-col"},e.createElement("div",{className:"min-w-[60mm] max-w-[60mm] min-h-[70mm] max-h-[70mm] rounded border shadow"},e.createElement("img",{src:m,alt:"Thumbnail",className:"object-contain h-full"})),e.createElement("div",{className:"px-4 mt-4"},e.createElement("div",{className:"pt-2 px-4 font-bold leading-tight"},o,", ",l),e.createElement("div",{className:"pb-2 px-2 italic leading-tight"},"Vol. ",s," No. ",i," (",r,")"),e.createElement("div",{className:"pb-2 px-2 leading-tight text-gray-700 italic text-center text-sm"},"Published Date: ",new Date(c).toLocaleDateString())))))}function c({journal:t,theses:o=[],search:l,onViewPdf:r,onBack:s,onRefresh:i}){const{authenticated:c,authData:m}=e.useContext(n),u=e.useMemo((()=>o?.filter((e=>!l||e.title?.toString()?.toLowerCase()?.includes(l.toLowerCase())||e.abstract?.toString()?.toLowerCase()?.includes(l.toLowerCase())||e.author?.toString().toLowerCase()?.includes(l.toLowerCase())||e.year?.toString()?.toLowerCase()?.includes(l.toLowerCase())))||[]),[o,l]);console.log(u);const d=e.useCallback(((e,t)=>{e.preventDefault(),e.stopPropagation();const o=new URL(pathname("/api/thesis/markfavorite"),window.location.origin),n=JSON.stringify({id:t,[m?.account]:m?.id});fetch(o,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8",Accept:"application/json; charset=UTF-8"},body:n}).then((e=>e.json())).then((({success:e,error:t})=>{t?a.fire({icon:"error",title:"Error",text:"Failed to mark thesis as favorite: "+t,toast:!0,showConfirmButton:!1,position:"center",timer:3e3}):e?i&&i():a.fire({icon:"error",title:"Error",text:"Failed to mark thesis as favorite",toast:!0,showConfirmButton:!1,position:"center",timer:3e3})})).catch(console.log)}),[m]);return e.createElement("div",{className:"w-full font-[Roboto] relative"},e.createElement("button",{type:"button",onClick:s,className:"flex items-center justify-start"},e.createElement("span",{className:"material-symbols-outlined"},"chevron_left"),e.createElement("span",{className:"underline"},"Back")),e.createElement("div",{className:"flex flex-col gap-y-4 lg:gap-y-0 lg:flex-row py-16"},e.createElement("div",{className:"lg:w-1/2"},e.createElement("div",{className:"min-w-[60mm] max-w-[60mm] min-h-[70mm] max-h-[70mm] rounded border shadow mx-auto"},e.createElement("img",{src:t?.thumbnail,alt:"Thumbnail",className:"object-contain h-full"}))),e.createElement("div",{className:"text-center min-w-[60mm]"},e.createElement("h2",{className:"font-bold text-lg"},t?.title,", ",t?.month),e.createElement("div",{className:"font-[400] text-sm text-gray-600"},"Vol. ",t?.volume," No. ",t?.number," (",t?.year,")"),e.createElement("div",{className:"font-bold text-sm text-gray-600 mt-3"},"Published Date"),e.createElement("div",{className:"text-sm text-gray-600"},new Date(t?.published_date).toLocaleDateString()),e.createElement("div",{className:"text-sm text-gray-600 mt-3"},o.length," Theses"))),e.createElement("div",{className:"min-h-[400px] px-2"},e.createElement("div",{className:"border-t"},e.createElement("div",{className:"-translate-y-[55%] ml-4 bg-white w-fit"},"Thesis")),e.createElement("div",{className:"mt-2 max-h-[380px] h-full overflow-y-auto w-full px-8"},0===u.length?e.createElement("span",{className:"py-8"},"No Theses found in ",l?"your search":"this journal","."):e.createElement("div",{className:"flex flex-wrap leading-tight gap-4"},u.map((t=>e.createElement("div",{key:t?.id,onClick:()=>r(t),className:"relative hover:bg-gray-200 hover:shadow w-1/2 p-2 cursor-pointer rounded"},c&&"admin"!==m?.account&&e.createElement("button",{type:"button",onClick:e=>d(e,t?.id),className:"absolute right-2 top-3 z-20 hover:text-yellow-500"},t?.favorite&&e.createElement("span",{className:"material-symbols-outlined text-green-700"},"bookmark_star"),!t?.favorite&&e.createElement("span",{className:"material-symbols-outlined"},"bookmark")),e.createElement("div",{className:"font-bold"},t?.title),e.createElement("div",{className:"text-sm font-[400] text-gray-600"},t?.author," (",t?.year,")"),e.createElement("div",{className:"leading-tight"},e.createElement("div",{className:"material-symbols-outlined aspect-square text-sm mr-1 font-bold"},"visibility"),e.createElement("div",{className:"inline pb-1 font-[500]"},t?.totalViews)))))))))}return function(){const{authenticated:a,authData:o}=e.useContext(n),[m,u]=e.useState(new URLSearchParams(new URL(window.location.href).search).get("search")||""),d=e.useMemo((()=>new URLSearchParams(new URL(window.location.href).search)),[]),h=e.useCallback((e=>{u(e),d.set("search",e),window.history.pushState({},"",`?${d.toString()}`)}),[]),[f,p]=e.useState([]),[w,x]=e.useState(null),g=e.useMemo((()=>f.reduce(((e,t)=>e.includes(t.year)?e:[...e,t.year].toSorted(((e,t)=>t-e))),[])),[f]),[b,v]=e.useState((new Date).getFullYear()),E=e.useMemo((()=>w?[]:f.filter((e=>e.year.toString()===b.toString()&&(!m||e.title?.toString()?.toLowerCase()?.includes(m.toLowerCase())||e.volume?.toString()?.toLowerCase()?.includes(m.toLowerCase())||e.number?.toString()?.toLowerCase()?.includes(m.toLowerCase())||e.month?.toLowerCase()?.includes(m.toLowerCase())||e.year?.toString()?.toLowerCase()?.includes(m.toLowerCase())||`${e.title?.toString()?.toLowerCase()}, ${e.month?.toString()?.toLowerCase()}`.includes(m.toLowerCase()))))),[f,b,m,w]),[y,N]=e.useState(1),C=e.useMemo((()=>Math.ceil(E.length/20)),[E]),k=e.useMemo((()=>0===E.length?void 0:E?.slice(20*(y-1),20*y)),[y,E,C]),S=e.useCallback((()=>N((e=>Math.min(C,Math.max(0===C?0:1,e+1))))),[C]),L=e.useCallback((()=>N((e=>Math.min(C,Math.max(0===C?0:1,e-1))))),[C]),j=async()=>{const e=new URL(pathname("/api/journal/public/all"),window.location.origin);e.searchParams.set(o?.account,o?.id);try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const{success:a,error:o}=await t.json();if(o)throw new Error(`HTTP error: ${o.message}`);if(a)return a.sort(((e,t)=>new Date(e.created_at).getTime()>new Date(t.created_at).getTime()?-1:new Date(e.created_at).getTime()==new Date(t.created_at).getTime()?0:1)),p(a),a}catch(e){console.log(e)}return[]};e.useEffect((()=>{j().catch()}),[]);const[T,D]=e.useState(),[P,R]=e.useState(),[M,U]=e.useState(),F=e.useCallback((e=>{const t=e?.title,a=e?.author,o=new URL(`read${e?.url}`,window.location.origin).toString();R(t),U(a),D(o)}),[]),B=e.useCallback((e=>{u(""),x(f.find((t=>t.id==e)))}),[f]),_=e.useCallback((async()=>{if(w){const e=w.id,t=await j(),a=t?.find((t=>t.id===e));x(a)}}),[w]);return e.createElement(e.Fragment,null,e.createElement("div",{className:"flex py-4 px-8 mt-4"},e.createElement("div",{className:"flex-grow mt-3"},e.createElement("h1",{className:"text-2xl font-bold text-center"},"Journals"),!w&&e.createElement("div",{className:"flex flex-wrap p-4 gap-4"},!!b&&(k?.map((t=>e.createElement(i,{key:t.id,id:t.id,title:t.title,volume:t.volume,number:t.number,month:t.month,thumbnail:t.thumbnail,year:t.year,publishedDate:t.published_date,onRefresh:j,onSelect:B})))||e.createElement("div",{className:"lg:col-span-2 xl:col-span-3 mx-auto"},e.createElement("div",{className:"h-[200px] mb-2"},e.createElement("div",{className:"border-2 border-gray-300 rounded-lg p-4"},e.createElement("div",{className:"text-gray-500"},"No journal found.")))))),!!w&&!!b&&e.createElement(c,{journal:w,theses:w.theses,onViewPdf:F,search:m,onBack:()=>x(null),onRefresh:_})),e.createElement("div",{className:"min-w-[326px] max-w-[326px] h-[600px] flex flex-col"},e.createElement("div",{className:"min-h-[400px] flex-grow"},e.createElement("div",{className:"font-bold text-xl mb-4 w-full"},"Year"),g.map(((a,o)=>e.createElement("button",{key:o,type:"button",className:t("flex items-center px-4 py-2 text-left",b.toString()===a.toString()?"bg-gray-200 font-bold":"hover:bg-gray-300"),onClick:()=>v(Number.parseInt(a))},a)))),e.createElement("div",{className:"flex-shrink text-slate-700 font-[600] w-full mb-3"},e.createElement(s,{search:m,onSearch:h})),e.createElement("div",{className:"text-slate-700 font-[600] max-w-full overflow-x-auto overflow-y-hidden"},e.createElement("div",{className:"flex"},Array.from({length:C}).map(((a,o)=>e.createElement("button",{key:o,type:"button",className:t("flex items-center px-4 py-2 text-left",y===o+1?"bg-gray-200 font-bold":"hover:bg-gray-300"),onClick:()=>N(o+1)},o+1))))),w?e.createElement("div",{className:"flex-shrink text-slate-700 font-[600] mx-auto"},e.createElement("div",{className:"p-4"},"Â ")):e.createElement("div",{className:"flex-shrink text-slate-700 font-[600] mx-auto"},e.createElement("button",{type:"button",className:"p-1 hover:text-yellow-700",onClick:()=>N(0===C?0:1)},"<<"),e.createElement("button",{type:"button",className:"p-1 hover:text-yellow-700",onClick:L},"<"," Prev"),e.createElement("button",{type:"button",className:"p-1 hover:text-yellow-700",onClick:S},"Next ",">"),e.createElement("button",{type:"button",className:"p-1 hover:text-yellow-700",onClick:()=>N(C)},">>")))),e.createElement(l,{open:!!w&&!!T,onClose:()=>{D(void 0),R(void 0),U(void 0)},content:a?e.createElement(r,{src:T}):e.createElement("div",{className:"w-full text-center min-h-[150px] pt-16"},"Please ",e.createElement("a",{href:pathname("/login"),className:"text-sky-700 underline"},"login")," to view journal/thesis."),header:P,showCancelButton:!1,showConfirmButton:!1,footer:M}))}}));