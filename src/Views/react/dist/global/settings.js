import{MainContext as e}from"/jsx/context";import{Courses as a,Departments as l,Year as t}from"/jsx/global/enums";import{Input as r,Select as n}from"/jsx/global/input";import{React as o,Sweetalert2 as m}from"/jsx/imports";function s({formData:e,onChange:a}){return o.createElement("div",{className:"p-8 min-w-96"},o.createElement(r,{disabled:!0,label:"Username",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_admin_user",placeholder:"Username",value:e.username}),o.createElement(r,{label:"Full Name",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_full_name",placeholder:"Full Name",value:e.full_name,onChange:l=>a({...e,full_name:l.target.value}),required:!0}),o.createElement(r,{type:"email",label:"Email Address",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_email",placeholder:"Email Address",value:e.email,onChange:l=>a({...e,email:l.target.value}),required:!0}),o.createElement(r,{type:"password",label:"Password",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_password",placeholder:"Password (Leave blank if not change)",value:e.password,onChange:l=>a({...e,password:l.target.value})}))}function c({formData:e,onChange:m}){return o.createElement("div",{className:"p-8 min-w-96"},o.createElement(r,{disabled:!0,label:"Student ID",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_student_id",placeholder:"Student ID",value:e.username}),o.createElement(r,{disabled:!0,label:"Full Name",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_full_name",placeholder:"Full Name",value:e.full_name}),o.createElement(r,{type:"email",label:"Email Address",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_email",placeholder:"Email Address",value:e.email,onChange:a=>m({...e,email:a.target.value}),required:!0}),o.createElement(n,{labelColor:"black",items:Object.entries(l).map((([e,a])=>({label:a,value:a}))),label:"Department",name:"edit_department",placeholder:"Department",value:e.department,onChange:a=>m({...e,department:a.target.value}),required:!0}),o.createElement(n,{labelColor:"black",items:Object.entries(a).map((([e,a])=>({label:a,value:a}))),label:"Course",name:"edit_course",placeholder:"Course",value:e.course,onChange:a=>m({...e,course:a.target.value}),required:!0}),o.createElement(n,{labelColor:"black",items:Object.entries(t).map((([e,a])=>({label:a,value:a}))),label:"Year",name:"edit_year",placeholder:"Year",value:e.year,onChange:a=>m({...e,year:a.target.value}),required:!0}),o.createElement(r,{type:"password",label:"Password",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_password",placeholder:"Password (Leave blank if not change)",value:e.password,onChange:a=>m({...e,password:a.target.value})}))}function i({formData:e,onChange:a}){return o.createElement("div",{className:"p-8 min-w-96"},o.createElement(r,{disabled:!0,label:"Employee ID",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_personnel_id",placeholder:"Employee ID",value:e.username}),o.createElement(r,{label:"Full Name",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_full_name",placeholder:"Full Name",value:e.full_name,onChange:l=>a({...e,full_name:l.target.value}),required:!0}),o.createElement(r,{type:"email",label:"Email Address",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_email",placeholder:"Email Address",value:e.email,onChange:l=>a({...e,email:l.target.value}),required:!0}),o.createElement(n,{labelColor:"black",items:Object.entries(l).map((([e,a])=>({label:a,value:a}))),label:"Department",name:"edit_department",placeholder:"Department",value:e.department,onChange:l=>a({...e,department:l.target.value}),required:!0}),o.createElement(r,{type:"password",label:"Password",inputClassName:"border-black",className:"mb-2",labelColor:"black",name:"edit_password",placeholder:"Password (Leave blank if not change)",value:e.password,onChange:l=>a({...e,password:l.target.value})}))}export default function d(){const{authenticated:a,authData:l}=o.useContext(e);if(!a||!l)return window.location.replace("/"),null;const t=o.useMemo((()=>a?l.account:null),[a,l]);console.log(a,l,t);const[r,n]=o.useState({username:"admin"===t?l?.admin_user||"":"student"===t?l?.student_id||"":"personnel"===t&&l?.personnel_id||"",full_name:l?.full_name||"",email:l?.email||"",password:"",department:l?.department||"",course:l?.course||"",year:l?.year||""}),d=o.useCallback((async e=>{e.preventDefault(),e.stopPropagation();try{const e=await fetch("/api/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,username:void 0,account:t})}),a=await e.json();a.success?(close(),m.fire({icon:"success",title:"Success",text:"Updated successfully.",timer:2e3}),setTimeout((()=>window.location.reload()),1e3)):m.fire({icon:"error",title:"Failed",text:a.error})}catch(e){console.log(e),m.fire({icon:"error",title:"Error",text:"Failed to update teacher account",confirmButtonText:"Try Again",showCancelButton:!0}).then((({isConfirmed:a})=>{a&&setTimeout((()=>d(e)),100)}))}}),[r,t]);return o.createElement("div",{className:"min-h-[calc(100vh-200px)] py-4 px-4 lg:px-8"},o.createElement("h1",{className:"text-2xl font-bold mt-8 mb-4"},"Account Settings"),o.createElement("form",{className:"border-t",onSubmit:d},o.createElement("div",{className:"flex max-w-full overflow-auto"},"admin"===t&&o.createElement(s,{formData:r,onChange:n}),"personnel"===t&&o.createElement(i,{formData:r,onChange:n}),"student"===t&&o.createElement(c,{formData:r,onChange:n})),o.createElement("div",{className:"ml-8"},o.createElement("button",{type:"button",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:()=>window.history.back()},"Cancel"),o.createElement("button",{type:"submit",className:"text-white bg-gradient-to-r from-cyan-500 to-blue-500 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-cyan-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2"},"Save"))))}