import e from"/jsx/global/clsx";import{React as t}from"/jsx/imports";export default function l(){const[l,s]=t.useState([]),[a,n]=t.useState(),o=/\[(USER_INFO|USER_DEBUG|USER_ERROR|USER_WARNING)\] ([^\[]+)/g,r=t.useCallback((e=>{const t=JSON.parse(e.data).logs.split("\n").map((e=>{const t=o.exec(e);return{type:t?.[1],message:t?.[2]}}));s(t)}),[]),c=t.useCallback((e=>{a?.OPEN&&a.close()}),[a]),m=t.useCallback((()=>{a?.OPEN&&a.close();const e=new URL("/api/stream/logs",window.location.origin),t=new EventSource(e,{withCredentials:!0});return n(t),t.onmessage=r,t.onerror=c,t}),[a,r,c]);return t.useEffect((()=>{const e=m();return console.log("event source: ",e),()=>{e?.OPEN&&e.close()}}),[]),t.createElement("div",null,t.createElement("h1",null,"Logs"),t.createElement("div",{className:"w-full p-8 min-h-[calc(100vh - 100px)]"},t.createElement("div",{className:"bg-slate-900 p-3 text-white border border-white rounded shadow mx-auto w-full h-full"},l.map((({type:l,message:s},a)=>t.createElement("p",{key:a},t.createElement("span",{className:e("text-green-300")},l),"Â ",t.createElement("span",null,s)))))))}