import{CellAlign as e,Table as t,TableCellType as l,TableRowAction as a}from"/jsx/admin/table";import{Tab as r,Tabs as i}from"/jsx/admin/tabs";import s from"/jsx/global/modal";import o from"/jsx/global/pdfviewer";import{React as n,Sweetalert2 as c}from"/jsx/imports";const u=[{label:"#",key:"id",sortable:!0,filterable:!0,cellType:l.Number,align:e.Center},{label:"Published Date",key:"created_at",sortable:!0,cellType:l.Date,align:e.Center},{label:"Title",key:"title",sortable:!0,cellType:l.String,align:e.Center},{label:"Abstract",key:"abstract",sortable:!0,cellType:l.String,align:e.Center},{label:"Author",key:"author",sortable:!0,cellType:l.String,align:e.Center},{label:"Year",key:"year",sortable:!0,cellType:l.Number,align:e.Center},{label:"Department",key:"department",sortable:!0,cellType:l.String,align:e.Center},{label:"Course",key:"course",sortable:!0,cellType:l.String,align:e.Center},{label:"Action",key:"action",sortable:!1,cellType:l.Custom,align:e.Center}];function m(){const[e,l]=n.useState(!1),[m,d]=n.useState(""),[h,b]=n.useState(""),[f,_]=n.useState(""),[p,y]=n.useState([]),[k,g]=n.useState([]),j=()=>{fetch("/api/thesis/published/all").then((e=>e.json())).then((({success:e,error:t})=>{t?console.log(t):y(e.map((e=>({id:e.id,created_at:e.created_at,title:e.fk_thesis_id?.title,abstract:e.abstract,author:e.fk_thesis_id?.author,year:e.fk_thesis_id?.year,department:e.fk_thesis_id?.department,course:e.fk_thesis_id?.course,action:n.createElement(a,{id:e.thesis_id,onView:t=>{t===e.thesis_id&&(b(e.fk_thesis_id?.title),_("Author/s: "+e.fk_thesis_id?.author+" ("+e.fk_thesis_id?.year+")"),d(new URL(`/read${e.fk_thesis_id?.url}`,window.location.origin).toString()))}})}))))})).catch((e=>{console.log(e),c.fire({icon:"error",title:"Error",text:"Failed to fetch published thesis list",confirmButtonText:"Try Again",showCancelButton:!0}).then((({isConfirmed:e})=>{e&&setTimeout((()=>j()),50)}))}))},E=()=>{fetch("/api/journal/published/all").then((e=>e.json())).then((({success:e,error:t})=>{t?console.log(t):g(e.map((e=>({id:e.id,created_at:e.created_at,title:e.fk_journal_id?.title,abstract:e.abstract,author:e.fk_journal_id?.author,year:e.fk_journal_id?.year,department:e.fk_journal_id?.department,course:e.fk_journal_id?.course,action:n.createElement(a,{id:e.journal_id,onView:t=>{t===e.journal_id&&(b(e.fk_journal_id?.title),_("Author/s: "+e.fk_journal_id?.author+" ("+e.fk_journal_id?.year+")"),d(new URL(`/read${e.fk_journal_id?.url}`,window.location.origin).toString()))}})}))))})).catch((e=>{console.log(e),c.fire({icon:"error",title:"Error",text:"Failed to fetch published journal list",confirmButtonText:"Try Again",showCancelButton:!0}).then((({isConfirmed:e})=>{e&&setTimeout((()=>E()),50)}))}))};return n.useEffect((()=>{m||(b(""),_(""))}),[m]),n.useEffect((()=>{j(),E()}),[]),n.createElement("div",{className:"w-full min-h-[calc(100vh-160px)] h-fit bg-[#37414e] p-4 min-w-fit"},n.createElement(i,{tabs:[{label:"Published Thesis",key:"thesis"},{label:"Published Journal",key:"journal"}]},n.createElement(r,{tabKey:"thesis"},n.createElement("h1",{className:"text-white text-2xl my-2"},"Published Thesis"),n.createElement(t,{columns:u,items:p},n.createElement("div",{className:"px-4"},n.createElement("button",{type:"button",onClick:()=>j(),className:"hover:text-yellow-500",title:"Refresh List"},n.createElement("span",{className:"material-symbols-outlined"},"refresh"))))),n.createElement(r,{tabKey:"journal"},n.createElement("h1",{className:"text-white text-2xl my-2"},"Published Journal"),n.createElement(t,{columns:u,items:k},n.createElement("div",{className:"px-4"},n.createElement("button",{type:"button",onClick:()=>j(),className:"hover:text-yellow-500",title:"Refresh List"},n.createElement("span",{className:"material-symbols-outlined"},"refresh")))))),n.createElement(s,{open:!!m,onClose:()=>d(null),content:n.createElement(o,{src:m}),header:h,showCancelButton:!1,showConfirmButton:!1,footer:f}))}export default m;