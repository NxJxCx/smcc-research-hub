export default import(pathname("/jsx/imports")).then((async({React:e,Sweetalert2:t,getAsyncImport:o})=>{const{CellAlign:a,TableCellType:l,TableColumn:n}=await import(pathname("/jsx/types")),{default:i}=await o("/jsx/admin/adddownloadable"),{Table:r,TableRowAction:s}=await o("/jsx/admin/table"),d=[{label:"#",key:"id",sortable:!0,filterable:!0,cellType:l.Number,align:a.Center},{label:"File Title",key:"title",sortable:!0,cellType:l.String,align:a.Center},{label:"File Name",key:"name",sortable:!0,cellType:l.String,align:a.Center},{label:"Date Created",key:"created_at",sortable:!0,cellType:l.Date,align:a.Center},{label:"Downloadable?",key:"downloadable",sortable:!0,cellType:l.Custom,align:a.Center},{label:"Action",key:"action",sortable:!1,cellType:l.Custom,align:a.Center}];return function(){const[o,a]=e.useState(!1),[l,n]=e.useState([]),c=()=>{fetch(pathname("/api/downloadables/all")).then((e=>e.json())).then((({success:o,error:a})=>{a?console.log(a):o&&n(o.map((o=>({id:o.id,created_at:o.created_at,title:o.title,name:o.name+o.ext,downloadable:{value:o.downloadable?"Yes":"No",content:o.downloadable?e.createElement("button",{type:"button",className:"bg-white px-3 py-2 text-green-700 font-bold rounded-2xl leading-[14.63px] text-[12px]",onClick:()=>{t.fire({icon:"question",title:"Do you want to make this file unavailable for download?",confirmButtonText:"Yes, make it unavailable for download",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"No, Cancel",denyButtonColor:"#d33",showLoaderOnConfirm:!0,preConfirm:async()=>{try{const e=new URL(pathname("/api/downloadables/publish"),window.location.origin),a=await fetch(e,{method:"POST",body:JSON.stringify({id:o.id,downloadable:!1}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!a.ok){const{error:e}=await a.json();return t.showValidationMessage("Failed: "+e)}return a.json()}catch(e){t.showValidationMessage("Failed: "+e)}},allowOutsideClick:()=>!t.isLoading()}).then((e=>{e.isConfirmed&&(e.value?.error?t.fire({icon:"error",title:"Error",text:"Failed to make this file unavailable for download: "+e.value.error,timer:3e3,toast:!0,position:"center"}):(t.fire({icon:"success",title:"File made unavailable for download",timer:3e3,toast:!0,position:"center"}),c()))}))}},"Yes"):e.createElement("button",{type:"button",className:"bg-white px-3 py-2 text-red-500 rounded-2xl font-[500] leading-[14.63px] text-[12px]",onClick:()=>{t.fire({icon:"question",title:"Do you want this file to be available for download?",confirmButtonText:"Yes, make it available",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"No, Cancel",denyButtonColor:"#d33",showLoaderOnConfirm:!0,preConfirm:async()=>{try{const e=new URL(pathname("/api/downloadables/publish"),window.location.origin),a=await fetch(e,{method:"POST",body:JSON.stringify({id:o.id,downloadable:!0}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!a.ok){const{error:e}=await a.json();return t.showValidationMessage("Failed: "+e)}return a.json()}catch(e){t.showValidationMessage("Failed: "+e)}},allowOutsideClick:()=>!t.isLoading()}).then((e=>{e.isConfirmed&&(e.value?.error?t.fire({icon:"error",title:"Error",text:"Failed to make file available for download: "+e.value.error,timer:3e3,toast:!0,position:"center"}):(t.fire({icon:"success",title:"File made available for download",timer:3e3,toast:!0,position:"center"}),c()))}))}},"No")},action:e.createElement(s,{id:o.id,onDownload:e=>{if(e===o.id){const e=window.open(new URL(pathname(`/download${o.url}`),window.location.origin),"_blank");setTimeout((()=>{e&&e.close()}),1e3)}},onDelete:e=>{t.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete downloadable file!"}).then((({isConfirmed:o})=>{o&&fetch(pathname(`/api/downloadables/delete?id=${e}`),{method:"DELETE"}).then((e=>e.json())).then((({success:e,error:o})=>{e?(c(),t.fire({icon:"success",title:"Deleted!",text:"Downloadable File has been deleted successfully.",timer:3e3})):(console.log(o),t.fire({icon:"error",title:"Error",text:"Failed to delete Downloadable File: "+o,confirmButtonText:"Try Again"}))})).catch((e=>{console.log(e),t.fire({icon:"error",title:"Error",text:"Failed to delete Downloadable File",timer:3e3})}))}))}})}))))})).catch((e=>{console.log(e),t.fire({icon:"error",title:"Error",text:"Failed to fetch Downloadable File list",confirmButtonText:"Try Again",showCancelButton:!0}).then((({isConfirmed:e})=>{e&&setTimeout((()=>c()),50)}))}))};return e.useEffect((()=>{c()}),[]),e.createElement("div",{className:"w-full min-h-[calc(100vh-160px)] h-fit bg-[#37414e] p-4 min-w-fit"},e.createElement("h1",{className:"text-white text-2xl my-2"},"Downloadable List"),e.createElement(r,{columns:d,items:l},e.createElement("div",{className:"px-4"},e.createElement("button",{type:"button",onClick:()=>c(),className:"hover:text-yellow-500",title:"Refresh List"},e.createElement("span",{className:"material-symbols-outlined"},"refresh"))),e.createElement("div",{className:"px-4"},e.createElement("button",{type:"button",onClick:()=>a(!0),className:"hover:text-yellow-500",title:"Add Thesis"},e.createElement("span",{className:"material-symbols-outlined"},"add"))),e.createElement(i,{open:o,onClose:()=>a(!1),onSuccess:()=>c(),className:"absolute right-3 top-full mt-4 shadow-lg"})))}}));