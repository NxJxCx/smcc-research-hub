import e from"../global/pdfviewer";import t from"/jsx/admin/addthesis";import{CellAlign as l,SortOrder as a,Table as o,TableCellType as n,TableRowAction as r}from"/jsx/admin/table";import s from"/jsx/global/modal";import{React as i,Sweetalert2 as c}from"/jsx/imports";const u=[{label:"#",key:"id",sortable:!0,filterable:!0,cellType:n.Number,align:l.Center},{label:"Date Created",key:"created_at",sortable:!0,cellType:n.Date,align:l.Center},{label:"Title",key:"title",sortable:!0,cellType:n.String,align:l.Center},{label:"Author",key:"author",sortable:!0,cellType:n.String,align:l.Center},{label:"Year",key:"year",sortable:!0,cellType:n.Number,align:l.Center},{label:"Status",key:"status",sortable:!0,cellType:n.Custom,align:l.Center},{label:"Action",key:"action",sortable:!1,cellType:n.Custom,align:l.Center}];function m(){const[l,n]=i.useState(!1),[m,d]=i.useState(""),[p,b]=i.useState(""),[h,y]=i.useState(""),[f,g]=i.useState(10),[x,C]=i.useState(""),[E,w]=i.useState(a.Ascending),[S,N]=i.useState([]),T=()=>{fetch("/api/thesis/all").then((e=>e.json())).then((({success:e,error:t})=>{t?console.log(t):N(e.map((e=>({id:e.id,created_at:e.created_at,title:e.title,author:e.author,year:e.year,status:{value:e.published?"Published":"Unpublished",content:e.published?i.createElement("button",{type:"button",className:"bg-white px-3 py-2 text-green-500 rounded-2xl font-[500] leading-[14.63px] text-[12px]",disabled:!0},"Published"):i.createElement("button",{type:"button",className:"bg-white px-3 py-2 text-red-500 rounded-2xl font-[500] leading-[14.63px] text-[12px]"},"Unpublished")},action:i.createElement(r,{id:e.id,onView:t=>{t===e.id&&(b(e.title),y("Author/s: "+e.author+" ("+e.year+")"),d(new URL(`/read${e.url}`,window.location.origin).toString()))},onDelete:e=>{}})}))))})).catch((e=>{console.log(e),c.fire({icon:"error",title:"Error",text:"Failed to fetch thesis list",confirmButtonText:"Try Again",showCancelButton:!0}).then((({isConfirmed:e})=>{e&&setTimeout((()=>T()),50)}))}))};return i.useEffect((()=>{m||(b(""),y(""))}),[m]),i.useEffect((()=>{T()}),[]),i.createElement("div",{className:"w-full min-h-[calc(100vh-160px)] h-fit bg-[#37414e] p-4 "},i.createElement(o,{columns:u,items:S},i.createElement("div",{className:"px-4"},i.createElement("button",{type:"button",onClick:()=>T(),className:"hover:text-yellow-500"},i.createElement("span",{className:"material-symbols-outlined"},"refresh"))),i.createElement("div",{className:"px-4"},i.createElement("button",{type:"button",onClick:()=>n(!0),className:"hover:text-yellow-500"},i.createElement("span",{className:"material-symbols-outlined"},"add"))),i.createElement(t,{open:l,onClose:()=>n(!1),onSuccess:()=>T(),className:"absolute right-3 top-full mt-4 shadow-lg"})),i.createElement(s,{open:!!m,onClose:()=>d(null),content:i.createElement(e,{src:m}),header:p,showCancelButton:!1,showConfirmButton:!1,footer:h}))}export default m;